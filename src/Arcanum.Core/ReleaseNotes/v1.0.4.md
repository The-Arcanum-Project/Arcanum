# Arcanum Aer 1.0.4

## Release Notes

### Parsing

- Optimized `ParserGenerator` to never generate code using reflection
- Fixed usage of `Activator<T>` to generate objects as they all enforce an empty constructor
- Reduced number of missed allocations for strings when checking keys in dictionaries
- Unrolled loops into generator logic to remove delegate overhead and generalization
- Inlined dynamic parsing loop and optimized individual checking for parsers
- Fixed run condition in parser to display the correct file on a syntax error
  --> Arcanum now loads 3-5x faster

### Fixes

- Fixed Loadorder for SocietalValues
- Fixed crash when resetting `savingSettings`
- Fixed Location templates not being saved as one liners
- Fixed naming for `AgsSettings` in settings tab
- Fixed limbo state of Arcanum if an unplanned exception occurs during parsing
- Fixed custom indentations not working in Saving
- Fixed selecting a search result in the Queastor not brining it up in UI if it was not an `IMapInferable`
- Removed legacy code causing different actions to occur once an object is selected in the search
- Fixed `SaveMaster` holding references to undone action targets if there are no actions left
- Fixed hex conversion to be in ARGB format and not in BGRA
- Fixed Dynasty saving
- Fixed Faulty formatting in location saving
- Fixed all errors being supressed by default
- Fixed Critical bug for a certain settings config corrupting the setup files
- Fixed race condition in ViewModelTextWriter causing Nullpointer Exception during shutdown, if a log is called during
  or after shutdown is initiated
- Fixed Command history not being saved
- Fixed Console access in debug mode not being more elaborate than in release
- Fixed issue where changes are not saved if the same property was the previous change
- Fixed empty lines acucmulating at the end of modified objects in already existing files
- Fixed faulty location lookup in map
- Fixed a dead lock when finishing tesselation early
- Fixed wrong command creation in some of the aggregateLinks when changing a parent in a child
- Fixed MapMode buttons not remembering their map mode assignments
- Fixed faulty undo and redo logic in SaveMaster
- Fixed definitions not being saved if `INJECT` or `REPLACE` usage was enabled
- Fixed commands not being finalized after an undo
- Fixed occasional crash when using rectangle selection
- Fixed error log not writing the log to a file when pressing the button with `LMB`
- Fixed wrong dependencies of loadingsteps causing crashes

### Featuers

- Added Splash Saving screen
- Exposed printLT to user
- Added PopUp Warning if you want to close Arcanum with unsave changes
- Error log can now be saved by default so even when parsing fails, it is written to the disk
- After selecting a search result it is now highlighted on the map
- When selecting a search result, we pan the map to it if possible
- Added `LocationValidation`
- Validators can now be invoked via the Console:
  `validator -l | validator -"<validator>" | Validates inputs or lists available validators.`
- Added Setup folder renaming (Dev only)
- Added support for conditional writing of blocks
- MapTracing is now ~25% faster
- Added custommmizable options to mark search results on the map
- Added command builder debug tool to easily build console commands
- The console now has Support for autocompletion triggering using CTRL + SPACE
- Added fast border smoothing option for faster startup times (must be enabled in settings)
- Improved performance of source generated getters and setters aswell as adding data to mark values as AggregateLinks
- Updated part of the documentation and added new starting Page
- Added MapMode exporting via `RMB` on the map
- Added support for `AggregateLink`s to display external properties in an object
- Added destructive and experiemental renamer in debug panel (debug mode only)
- Added ActionBar display to visualize what action was taken last.
