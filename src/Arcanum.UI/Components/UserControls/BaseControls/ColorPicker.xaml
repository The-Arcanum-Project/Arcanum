<UserControl x:Class = "Arcanum.UI.Components.UserControls.BaseControls.ColorPicker"
             xmlns = "http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x = "http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc = "http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d = "http://schemas.microsoft.com/expression/blend/2008"
             xmlns:converters = "clr-namespace:Arcanum.UI.Components.Converters"
             xmlns:styleClasses = "clr-namespace:Arcanum.UI.Components.StyleClasses"
             xmlns:baseControls = "clr-namespace:Arcanum.UI.Components.UserControls.BaseControls"
             xmlns:behaviors = "clr-namespace:Arcanum.UI.Components.Behaviors"
             mc:Ignorable = "d">
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source = "/Arcanum_UI;component/Assets/ArcanumShared/DefaultPalette.xaml" />
                <ResourceDictionary Source = "/Arcanum_UI;component/Assets/ArcanumShared/DefaultFonts.xaml" />
                <ResourceDictionary Source = "/Arcanum_UI;component/Components/Styles/Specific/HueSliderStyle.xaml" />
            </ResourceDictionary.MergedDictionaries>
            <converters:ColorToBrushConverter x:Key = "ColorToBrushConverter" />
            <converters:ColorToContrastingBrushConverter x:Key = "ContrastingBrushConverter" />
        </ResourceDictionary>
    </UserControl.Resources>

    <UserControl.DataContext>
        <baseControls:ColorPickerViewModel />
    </UserControl.DataContext>

    <Border BorderBrush = "{StaticResource DefaultBorderColorBrush}"
            BorderThickness = "2"
            Width = "400"
            Height = "270">
        <Grid Margin = "10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width = "3*" />
                <ColumnDefinition Width = "Auto" />
                <ColumnDefinition Width = "Auto" />
                <ColumnDefinition Width = "*" />
            </Grid.ColumnDefinitions>

            <Grid Grid.Column = "0">

                <Border BorderBrush = "{StaticResource DefaultBorderColorBrush}"
                        BorderThickness = "2">
                    <Rectangle>
                        <Rectangle.Fill>
                            <LinearGradientBrush StartPoint = "0,0.5"
                                                 EndPoint = "1,0.5">
                                <GradientStop Color = "White"
                                              Offset = "0" />
                                <GradientStop Color = "{Binding PureHueColor}"
                                              Offset = "1" />
                            </LinearGradientBrush>
                        </Rectangle.Fill>
                    </Rectangle>
                </Border>

                <Rectangle>
                    <Rectangle.Fill>
                        <LinearGradientBrush StartPoint = "0.5,0"
                                             EndPoint = "0.5,1">
                            <GradientStop Color = "Transparent"
                                          Offset = "0" />
                            <GradientStop Color = "Black"
                                          Offset = "1" />
                        </LinearGradientBrush>
                    </Rectangle.Fill>
                </Rectangle>

                <Canvas x:Name = "ColorSquareCanvas"
                        Background = "Transparent"
                        MouseDown = "ColorSquare_MouseDown"
                        MouseMove = "ColorSquare_MouseMove"
                        MouseUp = "ColorSquare_MouseUp">
                    <Ellipse x:Name = "ColorSelectorThumb"
                             Width = "8"
                             Height = "8"
                             StrokeThickness = "1"
                             Fill = "Transparent"
                             IsHitTestVisible = "False">
                        <Ellipse.Stroke>
                            <Binding Path = "SelectedColor"
                                     Converter = "{StaticResource ContrastingBrushConverter}" />
                        </Ellipse.Stroke>
                    </Ellipse>
                </Canvas>
            </Grid>

            <!-- 2. Hue Slider -->
            <Slider Grid.Column = "1"
                    x:Name = "HueSlider"
                    Orientation = "Vertical"
                    Minimum = "0"
                    Maximum = "360"
                    Value = "{Binding Hue, Mode=TwoWay}"
                    Margin = "5,0"
                    Style = "{StaticResource SliderWithoutTrackBarStyle}"
                    PreviewMouseLeftButtonDown = "HueSlider_PreviewMouseLeftButtonDown">
                <Slider.Background>
                    <LinearGradientBrush StartPoint = "0.5,1"
                                         EndPoint = "0.5,0">
                        <GradientStop Color = "Red"
                                      Offset = "0" />
                        <GradientStop Color = "Yellow"
                                      Offset = "0.167" />
                        <GradientStop Color = "Lime"
                                      Offset = "0.333" />
                        <GradientStop Color = "Cyan"
                                      Offset = "0.5" />
                        <GradientStop Color = "Blue"
                                      Offset = "0.667" />
                        <GradientStop Color = "Magenta"
                                      Offset = "0.833" />
                        <GradientStop Color = "Red"
                                      Offset = "1" />
                    </LinearGradientBrush>
                </Slider.Background>
            </Slider>

            <!-- 3. Text Inputs and Previews -->
            <StackPanel Grid.Column = "3"
                        VerticalAlignment = "Center">
                <!-- Color Preview -->
                <Border Width = "50"
                        Height = "50"
                        BorderBrush = "{StaticResource DefaultBorderColorBrush}"
                        BorderThickness = "1"
                        Background = "{Binding SelectedColor, Converter={StaticResource ColorToBrushConverter}}"
                        Margin = "0,0,-5,10"
                        CornerRadius = "8" />

                <!-- HSB/V Inputs -->
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width = "Auto" /><ColumnDefinition Width = "*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition /><RowDefinition /><RowDefinition />
                    </Grid.RowDefinitions>
                    <TextBlock Text = "H:"
                               Grid.Row = "0"
                               Grid.Column = "0"
                               VerticalAlignment = "Center"
                               Margin = "0, 0, 0, 2" />
                    <styleClasses:CorneredTextBox
                        Text = "{Binding Hue, Mode=TwoWay, StringFormat={}{0:F0}, UpdateSourceTrigger=PropertyChanged}"
                        Grid.Row = "0"
                        Grid.Column = "1"
                        Margin = "2, 0, 2, 2"
                        BorderThickness = "1"
                        CornerRadiusValue = "2"
                        FontFamily = "{StaticResource DefaultMonospacedFont}">
                    </styleClasses:CorneredTextBox>
                    <TextBlock Text = "S:"
                               Grid.Row = "1"
                               Grid.Column = "0"
                               VerticalAlignment = "Center"
                               Margin = "0, 0, 0, 2"
                               FontFamily = "{StaticResource DefaultMonospacedFont}" />
                    <styleClasses:CorneredTextBox
                        Text = "{Binding Saturation, Mode=TwoWay, StringFormat=P0, UpdateSourceTrigger=PropertyChanged}"
                        Grid.Row = "1"
                        Grid.Column = "1"
                        Margin = "2, 0, 2, 2"
                        BorderThickness = "1"
                        CornerRadiusValue = "2"
                        FontFamily = "{StaticResource DefaultMonospacedFont}">
                    </styleClasses:CorneredTextBox>
                    <TextBlock Text = "B:"
                               Grid.Row = "2"
                               Grid.Column = "0"
                               VerticalAlignment = "Center"
                               Margin = "0, 0, 0, 2"
                               FontFamily = "{StaticResource DefaultMonospacedFont}" />
                    <styleClasses:CorneredTextBox
                        Text = "{Binding Value, Mode=TwoWay, StringFormat=P0, UpdateSourceTrigger=PropertyChanged}"
                        Grid.Row = "2"
                        Grid.Column = "1"
                        Margin = "2, 0, 2, 2"
                        BorderThickness = "1"
                        CornerRadiusValue = "2"
                        FontFamily = "{StaticResource DefaultMonospacedFont}">
                    </styleClasses:CorneredTextBox>
                </Grid>

                <!-- RGB Inputs -->
                <Grid Margin = "0,10,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width = "Auto" /><ColumnDefinition Width = "*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition /><RowDefinition /><RowDefinition />
                    </Grid.RowDefinitions>
                    <TextBlock Text = "R:"
                               Grid.Row = "0"
                               Grid.Column = "0"
                               VerticalAlignment = "Center"
                               Margin = "0, 0, 0, 2"
                               FontFamily = "{StaticResource DefaultMonospacedFont}" />
                    <styleClasses:CorneredTextBox
                        Text = "{Binding Red, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                        Grid.Row = "0"
                        Grid.Column = "1"
                        Margin = "2, 0, 2, 2"
                        BorderThickness = "1"
                        CornerRadiusValue = "2"
                        FontFamily = "{StaticResource DefaultMonospacedFont}">
                    </styleClasses:CorneredTextBox>
                    <TextBlock Text = "G:"
                               Grid.Row = "1"
                               Grid.Column = "0"
                               VerticalAlignment = "Center"
                               Margin = "0, 0, 0, 2"
                               FontFamily = "{StaticResource DefaultMonospacedFont}" />
                    <styleClasses:CorneredTextBox
                        Text = "{Binding Green, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                        Grid.Row = "1"
                        Grid.Column = "1"
                        Margin = "2, 0, 2, 2"
                        BorderThickness = "1"
                        CornerRadiusValue = "2"
                        FontFamily = "{StaticResource DefaultMonospacedFont}">
                    </styleClasses:CorneredTextBox>
                    <TextBlock Text = "B:"
                               Grid.Row = "2"
                               Grid.Column = "0"
                               VerticalAlignment = "Center"
                               Margin = "0, 0, 0, 2"
                               FontFamily = "{StaticResource DefaultMonospacedFont}" />
                    <styleClasses:CorneredTextBox
                        Text = "{Binding Blue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                        Grid.Row = "2"
                        Grid.Column = "1"
                        Margin = "2, 0, 2, 2"
                        BorderThickness = "1"
                        CornerRadiusValue = "2"
                        FontFamily = "{StaticResource DefaultMonospacedFont}">
                    </styleClasses:CorneredTextBox>
                </Grid>

                <!-- Hex Input -->
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width = "Auto" /><ColumnDefinition Width = "*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height = "*" />
                    </Grid.RowDefinitions>


                    <TextBlock Text = "#:"
                               Grid.Column = "0"
                               VerticalAlignment = "Center"
                               Margin = "0, 10, 0, 2"
                               FontFamily = "{StaticResource DefaultMonospacedFont}" />

                    <styleClasses:CorneredTextBox
                        Text = "{Binding HexText, 
                       Mode=TwoWay, 
                       UpdateSourceTrigger=PropertyChanged}"
                        Margin = "2, 10, 2, 2"
                        BorderThickness = "1"
                        CornerRadiusValue = "2"
                        Grid.Column = "1"
                        FontFamily = "{StaticResource DefaultMonospacedFont}"
                        behaviors:TextBoxHelper.ForceUppercase = "True"
                        behaviors:TextBoxHelper.IsHexInput = "True">
                    </styleClasses:CorneredTextBox>
                </Grid>
            </StackPanel>
        </Grid>
    </Border>
</UserControl>