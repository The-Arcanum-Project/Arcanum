<styleClasses:BaseWindow x:Class = "Arcanum.UI.Components.Windows.PopUp.FileChange"
                         xmlns = "http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                         xmlns:x = "http://schemas.microsoft.com/winfx/2006/xaml"
                         xmlns:mc = "http://schemas.openxmlformats.org/markup-compatibility/2006"
                         xmlns:d = "http://schemas.microsoft.com/expression/blend/2008"
                         xmlns:styleClasses = "clr-namespace:Arcanum.UI.Components.StyleClasses"
                         xmlns:popUp = "clr-namespace:Arcanum.UI.Components.Windows.PopUp"
                         xmlns:converters = "clr-namespace:Arcanum.UI.Components.Converters"
                         mc:Ignorable = "d"
                         Title = "File Changes Detected"
                         Height = "400"
                         Width = "500"
                         SizeToContent = "Height"
                         FooterHeight = "0"
                         ShowInTaskbar = "False"
                         ShowMaximizeButton = "False"
                         ShowMinimizeButton = "False"
                         WindowBorderThickness = "2"
                         BorderBrush = "{StaticResource DefaultBorderColorBrush}"
                         WindowCornerRadius = "4"
                         AllowsTransparency = "True"
                         Background = "{StaticResource DefaultBackColorBrush}">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source = "/Arcanum_UI;component/Assets/ArcanumShared/DefaultPalette.xaml" />
                <ResourceDictionary Source = "/Arcanum_UI;component/Components/Styles/Base/BaseButton.xaml" />
            </ResourceDictionary.MergedDictionaries>
            <converters:BoolToVisibilityConverter x:Key = "BoolToVisibilityConverter" />
        </ResourceDictionary>
    </Window.Resources>

    <Grid Margin = "16">
        <Grid.RowDefinitions>
            <RowDefinition Height = "Auto" />
            <RowDefinition Height = "*" />
            <RowDefinition Height = "Auto" />
        </Grid.RowDefinitions>

        <!-- Info Text -->
        <TextBlock Grid.Row = "0"
                   TextWrapping = "Wrap"
                   Margin = "0,0,0,12"
                   FontWeight = "SemiBold"
                   Text = "{Binding InfoText, RelativeSource={RelativeSource AncestorType=popUp:FileChange}}" />

        <!-- Changed files list -->
        <ListView Grid.Row = "1"
                  ItemsSource = "{Binding FileChanges, RelativeSource={RelativeSource AncestorType=popUp:FileChange}}">
            <ListView.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation = "Horizontal">
                        <TextBlock Text = "{Binding Action}"
                                   FontWeight = "Bold"
                                   Foreground = "{Binding ActionColor}"
                                   Margin = "0,0,10,0" />
                        <TextBlock Text = "{Binding FilePath}" />
                    </StackPanel>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>

        <!-- Action buttons -->
        <StackPanel Grid.Row = "2"
                    Orientation = "Horizontal"
                    HorizontalAlignment = "Right"
                    Margin = "0,16,0,0">
            <!-- Buttons visibility determined by view model -->
            <styleClasses:BaseButton Content = "OK"
                                     Width = "80"
                                     Visibility = "{Binding ShowOkButton, RelativeSource={RelativeSource AncestorType=popUp:FileChange} , Converter={StaticResource BoolToVisibilityConverter}}"
                                     Click = "ButtonBase_OnClickOk" />

            <styleClasses:BaseButton Content = "Reload and Save"
                                     Width = "120"
                                     Visibility = "{Binding ShowReloadSaveButtons, RelativeSource={RelativeSource AncestorType=popUp:FileChange}, Converter={StaticResource BoolToVisibilityConverter}}"
                                     Margin = "4,0"
                                     ToolTip = "Save changes in Arcanum and reload from file. Manual changes might be overwritten."
                                     Click = "ButtonBase_OnClickSave" />

            <styleClasses:BaseButton Content = "Reload and Discard"
                                     Width = "130"
                                     Visibility = "{Binding ShowReloadSaveButtons, RelativeSource={RelativeSource AncestorType=popUp:FileChange}, Converter={StaticResource BoolToVisibilityConverter}}"
                                     Margin = "4,0"
                                     ToolTip = "Discard changes in Arcanum and reload from file. History reload might not be available on next launch."
                                     Click = "ButtonBase_OnClickDiscard" />

            <styleClasses:BaseButton Content = "Back to Main Menu and Discard"
                                     Width = "140"
                                     Visibility = "{Binding ShowReloadSaveButtons, RelativeSource={RelativeSource AncestorType=popUp:FileChange}, Converter={StaticResource BoolToVisibilityConverter}}"
                                     Margin = "4,0"
                                     ToolTip = "Return to the main menu discarding changes. History reload might not be available on next launch."
                                     Click = "ButtonBase_OnClickMenu" />
        </StackPanel>
    </Grid>
</styleClasses:BaseWindow>